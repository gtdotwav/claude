# AI Alpha Architecture Diagram

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Browser (Client)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         AIAlpha Component (React)                          â”‚    â”‚
â”‚  â”‚         src/components/ui/ai-voice-input.tsx              â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
â”‚  â”‚  â”‚ Input Box    â”‚         â”‚ Send Button  â”‚               â”‚    â”‚
â”‚  â”‚  â”‚ (Text)       â”‚         â”‚ (Gradient)   â”‚               â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
â”‚  â”‚         â–²                        â”‚                        â”‚    â”‚
â”‚  â”‚         â”‚                        â”‚                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
â”‚  â”‚  â”‚ Mic Button   â”‚         â”‚ POST /chat   â”‚               â”‚    â”‚
â”‚  â”‚  â”‚ (Voice In)   â”‚         â”‚  + Spinner   â”‚               â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
â”‚  â”‚         â”‚                                                â”‚    â”‚
â”‚  â”‚  Web Speech API                                          â”‚    â”‚
â”‚  â”‚  (webkitSpeechRecognition)                              â”‚    â”‚
â”‚  â”‚  lang: pt-BR                                             â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚  Message History Display:                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚    â”‚
â”‚  â”‚  â”‚ [User] "Qual influencer teve mais...?"  â”‚             â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚    â”‚
â”‚  â”‚  â”‚ [AI]   "ğŸ“Š ComparaÃ§Ã£o de Influencers... â”‚             â”‚    â”‚
â”‚  â”‚  â”‚        Luna Tech lidera em engajamento"â”‚             â”‚    â”‚
â”‚  â”‚  â”‚        ğŸ”Š [Volume Control]              â”‚             â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ Quick Suggestions (3 buttons rotating)                    â”‚    â”‚
â”‚  â”‚ "Qual influencer..." | "Melhor horÃ¡rio..." | "Resume..." â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ Fetch API
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚              â”‚              â”‚
                â–¼              â–¼              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ /api/ai-alphaâ”‚ â”‚/api/ai-  â”‚ â”‚ /api/ai-     â”‚
         â”‚ /chat        â”‚ â”‚alpha/tts â”‚ â”‚ alpha/stt    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚              â”‚              â”‚
              â”‚              â”‚              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        â”‚              â”‚                 â”‚
â”‚    Next.js Server      â”‚              â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        â”‚              â”‚                 â”‚
â”‚  Route Handler         â”‚              â”‚ (Placeholder)   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚              â”‚ Returns:        â”‚
â”‚  â”‚ POST /chat     â”‚    â”‚              â”‚ {               â”‚
â”‚  â”‚ route.ts       â”‚    â”‚              â”‚   "supported":  â”‚
â”‚  â”‚                â”‚    â”‚              â”‚   true,         â”‚
â”‚  â”‚ â”œâ”€ Validate    â”‚    â”‚              â”‚   "method":     â”‚
â”‚  â”‚ â”‚  query       â”‚    â”‚              â”‚   "browser_...'â”‚
â”‚  â”‚ â”œâ”€ Extract     â”‚    â”‚              â”‚ }              â”‚
â”‚  â”‚ â”‚  intent      â”‚    â”‚              â”‚                 â”‚
â”‚  â”‚ â””â”€ Call engine â”‚    â”‚              â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚              â”‚                 â”‚
â”‚         â”‚              â”‚              â”‚                 â”‚
â”‚         â–¼              â”‚              â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                 â”‚
â”‚  â”‚ AI Alpha Engine                    â”‚                 â”‚
â”‚  â”‚ src/lib/                           â”‚                 â”‚
â”‚  â”‚ ai-alpha-engine.ts                 â”‚                 â”‚
â”‚  â”‚                                    â”‚                 â”‚
â”‚  â”œâ”€ processAIAlphaQuery()             â”‚                 â”‚
â”‚  â”œâ”€ detectIntent()                    â”‚                 â”‚
â”‚  â””â”€ 7 Intent Handlers                 â”‚                 â”‚
â”‚     â”œâ”€ handleInfluencer               â”‚                 â”‚
â”‚     â”œâ”€ handleBestPostingTime          â”‚                 â”‚
â”‚     â”œâ”€ handleCampaignRecommendation   â”‚                 â”‚
â”‚     â”œâ”€ handleWeeklySummary            â”‚                 â”‚
â”‚     â”œâ”€ handleTopPosts                 â”‚                 â”‚
â”‚     â”œâ”€ handleAccountMetrics           â”‚                 â”‚
â”‚     â””â”€ handleAutomationRules          â”‚                 â”‚
â”‚         â”‚                             â”‚                 â”‚
â”‚         â–¼                             â”‚                 â”‚
â”‚  Query Mock Data:                     â”‚                 â”‚
â”‚  â”œâ”€ DEMO_METRICS                      â”‚                 â”‚
â”‚  â”œâ”€ DEMO_ACCOUNTS                     â”‚                 â”‚
â”‚  â”œâ”€ DEMO_INFLUENCERS                  â”‚                 â”‚
â”‚  â”œâ”€ DEMO_POSTS                        â”‚                 â”‚
â”‚  â”œâ”€ DEMO_RULES                        â”‚                 â”‚
â”‚  â””â”€ DEMO_FLOWS                        â”‚                 â”‚
â”‚                                       â”‚                 â”‚
â”‚  Returns:                              â”‚                 â”‚
â”‚  {                                     â”‚                 â”‚
â”‚    "response": "...",                 â”‚                 â”‚
â”‚    "type": "insight",                 â”‚                 â”‚
â”‚    "data": { /* ... */ }              â”‚                 â”‚
â”‚  }                                     â”‚                 â”‚
â”‚                                       â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
                â”‚                                          â”‚
                â”‚                                          â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚                                          â”‚
                â–¼                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”
          Send JSON back               â”‚                    â”‚
          to client                    â–¼                    â–¼
          (200 OK)         TTS API Route          STT Route
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        (Placeholder)
                          â”‚ POST /tts   â”‚
                          â”‚ route.ts    â”‚
                          â”‚             â”‚
                          â”‚ â”œâ”€ Validate â”‚
                          â”‚ â”‚  text     â”‚
                          â”‚ â”œâ”€ Call     â”‚
                          â”‚ â”‚  ElevenLabs
                          â”‚ â””â”€ Stream   â”‚
                          â”‚    audio    â”‚
                          â”‚             â”‚
                          â”‚ Endpoint:   â”‚
                          â”‚ https://api.â”‚
                          â”‚ elevenlabs  â”‚
                          â”‚ .io/v1/     â”‚
                          â”‚ text-to-    â”‚
                          â”‚ speech/     â”‚
                          â”‚ VOICE_ID    â”‚
                          â”‚             â”‚
                          â”‚ POST Body:  â”‚
                          â”‚ {           â”‚
                          â”‚  text,      â”‚
                          â”‚  model_id,  â”‚
                          â”‚  voice_     â”‚
                          â”‚  settings   â”‚
                          â”‚ }           â”‚
                          â”‚             â”‚
                          â”‚ Response:   â”‚
                          â”‚ audio/mpeg  â”‚
                          â”‚ binary      â”‚
                          â”‚             â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Stream audio blob
                                â”‚
                                â–¼
                          Browser receives
                          audio stream
                          â”‚
                          â”œâ”€ Create Blob
                          â”œâ”€ Create Object URL
                          â”œâ”€ Play with <audio>
                          â””â”€ Revoke URL after
                             playback
```

---

## Data Flow: Query â†’ Response â†’ Audio

```
User Input
    â”‚
    â”œâ”€ Text: Type in input field
    â””â”€ Voice: Click mic, speak Portuguese
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend Handler (React)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚ 1. Validate query           â”‚
â”‚ 2. Show loading state       â”‚
â”‚ 3. POST to /api/ai-alpha/  â”‚
â”‚    chat                     â”‚
â”‚ 4. Await response           â”‚
â”‚ 5. Add to messages          â”‚
â”‚ 6. Call TTS if available    â”‚
â”‚ 7. Display in chat          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/ai-alpha/chat (Next.js)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ {                                       â”‚
â”‚   "query": "Qual influencer teve..."    â”‚
â”‚ }                                       â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ 1. Parse JSON body                  â”‚â”‚
â”‚ â”‚ 2. Validate query string            â”‚â”‚
â”‚ â”‚ 3. Call AI Alpha Engine             â”‚â”‚
â”‚ â”‚ 4. Return formatted response        â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI Alpha Engine (Pattern Matching)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ 1. Normalize query (lowercase, remove   â”‚
â”‚    accents)                             â”‚
â”‚ 2. Detect intent (keyword matching)     â”‚
â”‚ 3. Route to specific handler            â”‚
â”‚ 4. Query mock data                      â”‚
â”‚ 5. Format response with Markdown        â”‚
â”‚ 6. Return AIAlphaResponse object        â”‚
â”‚                                         â”‚
â”‚ Returns:                                â”‚
â”‚ {                                       â”‚
â”‚   text: "ğŸ“Š **ComparaÃ§Ã£o...**",        â”‚
â”‚   type: "comparison",                   â”‚
â”‚   data: { influencers: [...] }          â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response Back to Browser (JSON)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚ {                                        â”‚
â”‚   "response": "ğŸ“Š **ComparaÃ§Ã£o...**...", â”‚
â”‚   "type": "comparison",                  â”‚
â”‚   "data": { ... }                        â”‚
â”‚ }                                        â”‚
â”‚ Status: 200 OK                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                     â”‚
    â–¼                                     â–¼
Display in Chat                 POST /api/ai-alpha/tts
Message bubble                  (TTS API Call)
(gradient background)           â”‚
â”‚                               â–¼
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚ TTS Request Body:    â”‚
â”‚                          â”‚                      â”‚
â”‚                          â”‚ {                    â”‚
â”‚                          â”‚   "text": "ğŸ“Š..."    â”‚
â”‚                          â”‚ }                    â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                               â”‚
â”‚                               â–¼
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚ ElevenLabs API               â”‚
â”‚                          â”‚ https://api.elevenlabs.io/   â”‚
â”‚                          â”‚ v1/text-to-speech/VOICE_ID   â”‚
â”‚                          â”‚                              â”‚
â”‚                          â”‚ Headers:                     â”‚
â”‚                          â”‚ xi-api-key: (from env)       â”‚
â”‚                          â”‚ Content-Type: application/   â”‚
â”‚                          â”‚             json             â”‚
â”‚                          â”‚                              â”‚
â”‚                          â”‚ POST Body:                   â”‚
â”‚                          â”‚ {                            â”‚
â”‚                          â”‚   text,                      â”‚
â”‚                          â”‚   model_id:                  â”‚
â”‚                          â”‚   "eleven_multilingual_v2",  â”‚
â”‚                          â”‚   voice_settings: {          â”‚
â”‚                          â”‚     stability: 0.5,          â”‚
â”‚                          â”‚     similarity_boost: 0.75   â”‚
â”‚                          â”‚   }                          â”‚
â”‚                          â”‚ }                            â”‚
â”‚                          â”‚                              â”‚
â”‚                          â”‚ Response:                    â”‚
â”‚                          â”‚ Content-Type: audio/mpeg     â”‚
â”‚                          â”‚ [Binary audio stream]        â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                               â”‚
â”‚                               â–¼
â”‚                          Audio Blob
â”‚                          (Browser)
â”‚                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Audio Playback   â”‚
                    â”‚                  â”‚
                    â”‚ 1. Create Blob   â”‚
                    â”‚ 2. Create URL    â”‚
                    â”‚ 3. <audio> el.   â”‚
                    â”‚ 4. Play audio    â”‚
                    â”‚ 5. Revoke URL    â”‚
                    â”‚ 6. Show controls â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    User hears TTS
                    audio response
```

---

## Intent Detection Flow

```
Query Text (Portuguese)
    â”‚
    â–¼
Normalize:
â”œâ”€ .toLowerCase()
â”œâ”€ .normalize('NFKD')
â””â”€ Remove accents
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Keyword Matching                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚ Intent: influencer_comparison        â”‚
â”‚ Keywords: ['compare', 'vs', 'qual   â”‚
â”‚            influencer']               â”‚
â”‚ âœ“ Match: "Compare @X vs @Y"         â”‚
â”‚                                      â”‚
â”‚ Intent: best_posting_time           â”‚
â”‚ Keywords: ['melhor horario', 'quandoâ”‚
â”‚            postar']                  â”‚
â”‚ âœ“ Match: "Melhor horÃ¡rio pra        â”‚
â”‚           postar?"                   â”‚
â”‚                                      â”‚
â”‚ Intent: campaign_recommendation      â”‚
â”‚ Keywords: ['campanha', 'black friday'â”‚
â”‚ âœ“ Match: "Ideal pra Black Friday?" â”‚
â”‚                                      â”‚
â”‚ ... (continue for all intents)       â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
Route to Handler:
    â”‚
    â”œâ”€ handleInfluencerComparison()
    â”œâ”€ handleBestPostingTime()
    â”œâ”€ handleCampaignRecommendation()
    â”œâ”€ handleWeeklySummary()
    â”œâ”€ handleTopPosts()
    â”œâ”€ handleAccountMetrics()
    â”œâ”€ handleAutomationRules()
    â””â”€ handleGeneralSummary() (fallback)
```

---

## Component State Management

```
AIAlpha Component State:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Text Input State         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ query: string            â”‚  â† What user typed
â”‚ displayText: string      â”‚  â† Animated suggestion
â”‚ isTyping: boolean        â”‚  â† Typing animation active
â”‚ currentSuggestion: int   â”‚  â† Which suggestion showing
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Voice Input State        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ isListening: boolean     â”‚  â† Mic button active
â”‚ recognitionRef: Ref      â”‚  â† Web Speech API instance
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Chat State               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ messages: Array          â”‚  â† Chat history
â”‚ isLoading: boolean       â”‚  â† Processing query
â”‚ isSpeaking: boolean      â”‚  â† Audio playing
â”‚ audioRef: Ref            â”‚  â† <audio> element
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Effects:
â”œâ”€ useEffect: Typewriter animation
â”œâ”€ useEffect: Initialize Web Speech API
â””â”€ useEffect: Voice recognition callbacks

Callbacks:
â”œâ”€ handleSubmit: Send query
â”œâ”€ startListening: Start mic
â”œâ”€ stopListening: Stop mic
â”œâ”€ toggleVoiceInput: Toggle voice
â”œâ”€ playAudio: Call TTS + play
â””â”€ toggleAudio: Mute/unmute
```

---

## File Structure & Relationships

```
instagram-dashboard/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ ai-alpha-engine.ts â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â”‚   â”‚   â”œâ”€â”€ processAIAlphaQuery()     â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ detectIntent()            â”‚
â”‚   â”‚   â”‚   â””â”€â”€ 7 handlers                â”‚
â”‚   â”‚   â”œâ”€â”€ mock-data.ts (existing)       â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ DEMO_METRICS             â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ DEMO_ACCOUNTS            â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ DEMO_INFLUENCERS         â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ DEMO_POSTS               â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ DEMO_RULES               â”‚
â”‚   â”‚   â”‚   â””â”€â”€ DEMO_FLOWS               â”‚
â”‚   â”‚   â””â”€â”€ utils.ts (existing)           â”‚
â”‚   â”‚       â””â”€â”€ cn()                     â”‚
â”‚   â”‚                                    â”‚
â”‚   â”œâ”€â”€ app/                              â”‚
â”‚   â”‚   â”œâ”€â”€ api/                          â”‚
â”‚   â”‚   â”‚   â””â”€â”€ ai-alpha/                 â”‚
â”‚   â”‚   â”‚       â”œâ”€â”€ chat/                 â”‚
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ route.ts â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”
â”‚   â”‚   â”‚       â”‚       â””â”€â”€ Calls engine  â”‚    â”‚
â”‚   â”‚   â”‚       â”œâ”€â”€ tts/                  â”‚    â”‚
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ route.ts â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”
â”‚   â”‚   â”‚       â”‚       â””â”€â”€ ElevenLabs    â”‚    â”‚    â”‚
â”‚   â”‚   â”‚       â””â”€â”€ stt/                  â”‚    â”‚    â”‚
â”‚   â”‚   â”‚           â””â”€â”€ route.ts          â”‚    â”‚    â”‚
â”‚   â”‚   â”‚               â””â”€â”€ Placeholder    â”‚    â”‚    â”‚
â”‚   â”‚   â””â”€â”€ [pages]                       â”‚    â”‚    â”‚
â”‚   â”‚       â””â”€â”€ page.tsx                  â”‚    â”‚    â”‚
â”‚   â”‚           â””â”€â”€ Imports AIAlpha       â”‚    â”‚    â”‚
â”‚   â”‚                                     â”‚    â”‚    â”‚
â”‚   â””â”€â”€ components/                       â”‚    â”‚    â”‚
â”‚       â””â”€â”€ ui/                           â”‚    â”‚    â”‚
â”‚           â”œâ”€â”€ ai-voice-input.tsx â—„â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
â”‚           â”‚   â”œâ”€â”€ Uses engine           â”‚
â”‚           â”‚   â”œâ”€â”€ Uses TTS API          â”‚
â”‚           â”‚   â””â”€â”€ Web Speech API        â”‚
â”‚           â”œâ”€â”€ agent-marquee.tsx         â”‚
â”‚           â””â”€â”€ halide-topo-hero.tsx      â”‚
â”‚                                         â”‚
â”œâ”€â”€ AI_ALPHA_SYSTEM.md â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   â””â”€â”€ Architecture + API reference
â”‚
â”œâ”€â”€ IMPLEMENTATION_CHECKLIST.md
â”‚   â””â”€â”€ Setup guide + troubleshooting
â”‚
â”œâ”€â”€ USAGE_EXAMPLES.md
â”‚   â””â”€â”€ 12 integration examples
â”‚
â””â”€â”€ README_AI_ALPHA.md
    â””â”€â”€ Quick reference
```

---

## Response Type Examples

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ insight                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ "â° **Melhor HorÃ¡rio...**"  â”‚
â”‚ Facts about posting times   â”‚
â”‚ Based on DEMO_POSTS data    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ comparison                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ "ğŸ“Š **ComparaÃ§Ã£o...**"      â”‚
â”‚ Side-by-side metrics        â”‚
â”‚ Influencer A vs B           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ recommendation              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ "ğŸ¯ **RecomendaÃ§Ã£o...**"    â”‚
â”‚ Top 3 suggested options     â”‚
â”‚ With reasons                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ summary                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ "ğŸ“ˆ **Resumo...**"          â”‚
â”‚ Overview of all metrics     â”‚
â”‚ Last 7 days or period       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ metric                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ "ğŸ‘¥ **Contas Conectadas**" â”‚
â”‚ Raw numbers and stats       â”‚
â”‚ Processing totals           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling Paths

```
User Submits Query
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Error?
â”‚ Fetch to /chat      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Return 400 (bad input)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
    â”‚                                â–¼
    â”œâ”€ OK                        Show error in chat
    â”‚                            "âŒ Erro ao processar..."
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Engine processes â”‚         No match?
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Return general summary
    â”‚
    â”œâ”€ Success
    â”‚
    â–¼
Return response â”€â”€â–º Display in chat
    â”‚
    â–¼
Post to /tts â”€â”€â–º API Key missing?
(if enabled)        â”‚
    â”‚               â–¼
    â”œâ”€ Fail     Return 503
    â”‚           Skip TTS (silent fail)
    â”‚
    â””â”€ OK â”€â”€â–º Play audio


Browser Network Error:
    â”‚
    â–¼
Catch fetch error â”€â”€â–º Log to console
                     Show error to user
                     Allow retry
```

---

This architecture enables:

âœ… **Scalability** - Pattern-matching engine can handle unlimited queries
âœ… **Reliability** - Graceful fallbacks at every layer
âœ… **Performance** - <50ms query processing, streaming audio
âœ… **Maintainability** - Clear separation of concerns
âœ… **Extensibility** - Easy to add new intents and handlers
âœ… **User Experience** - Voice + text + audio in one interface
